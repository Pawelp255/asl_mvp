<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ASL Avatar (Dictionary Player)</title>
  <style>
    :root { --bg:#0b0b0b; --fg:#f5f5f5; --muted:#b5b5b5; --border:#2a2a2a; --soft:#151515; --accent:#00ff7f; }
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:var(--bg); color:var(--fg); }
    header { padding: 14px 16px; border-bottom:1px solid var(--border); background: #0f0f0f; display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
    header a { color: var(--fg); text-decoration:none; border:1px solid var(--border); padding:8px 10px; border-radius:10px; background:var(--soft); }
    header a:hover { border-color: var(--accent); }
    .wrap { padding: 16px; display:grid; grid-template-columns: 420px 1fr; gap: 16px; align-items:start; }
    @media (max-width: 980px) { .wrap { grid-template-columns: 1fr; } }

    .panel { border:1px solid var(--border); border-radius:14px; padding:14px; background: #101010; }
    .muted { color: var(--muted); font-size: 13px; }
    .row { display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:10px; }
    textarea { width:100%; min-height: 120px; border-radius: 12px; border:1px solid var(--border); background:#0d0d0d; color:var(--fg); padding:10px; outline:none; }
    button, select, input {
      padding:10px 12px; border-radius: 12px; border:1px solid var(--border);
      background: #0d0d0d; color:var(--fg); cursor:pointer;
    }
    button:hover { border-color: var(--accent); }
    .badge { display:inline-block; border:1px solid var(--border); background:#0d0d0d; padding:6px 10px; border-radius:999px; color:var(--muted); font-size:12px; }
    .kpi { display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:10px; }
    .kpi b { color: var(--fg); }
    .stage { position: relative; border-radius:14px; overflow:hidden; border:1px solid var(--border); background:#000; }
    video { width:100%; height: 540px; display:block; background:#000; }
    .overlay {
      position:absolute; left:12px; top:12px; display:flex; flex-direction:column; gap:8px;
      pointer-events:none;
    }
    .overlay .pill {
      background: rgba(0,0,0,0.55); border:1px solid rgba(255,255,255,0.15);
      padding: 6px 10px; border-radius: 999px; font-size: 12px; color: #fff;
      backdrop-filter: blur(6px);
    }
    .queueBox { margin-top: 10px; padding: 10px; border-radius: 12px; border:1px dashed var(--border); background:#0d0d0d; }
    .queueBox code { color: var(--accent); }
  </style>
</head>
<body>
  <header>
    <b>ASL Avatar (Dictionary Player)</b>
    <span class="muted">Plays known ASL words first, otherwise falls back to fingerspelling.</span>
    <a href="./index.html">← Back to main app</a>
  </header>

  <div class="wrap">
    <div class="panel">
      <div class="muted">
        Type text → we try to match <b>phrases/words</b> from dictionary (<code>/data/asl_dictionary.json</code>).
        Unknown words → spelled letter-by-letter using <code>/assets/asl/letters/*.mp4</code>.
      </div>

      <div class="row">
        <label class="badge">Mode:
          <select id="mode">
            <option value="words_first" selected>Words first (dictionary → letters)</option>
            <option value="letters_only">Letters only (always fingerspell)</option>
          </select>
        </label>

        <label class="badge">Speed:
          <select id="speed">
            <option value="0.9">Fast</option>
            <option value="1.0" selected>Normal</option>
            <option value="1.15">Slow</option>
          </select>
        </label>

        <label class="badge">Loop idle:
          <select id="idle">
            <option value="off" selected>Off</option>
            <option value="on">On</option>
          </select>
        </label>
      </div>

      <div class="row">
        <button id="loadBtn">Reload dictionary</button>
        <button id="playBtn">Play</button>
        <button id="pauseBtn" disabled>Pause</button>
        <button id="stopBtn" disabled>Stop</button>
      </div>

      <div class="row">
        <button id="prevBtn" disabled>Prev</button>
        <button id="nextBtn" disabled>Next</button>
        <span class="badge">Queue: <b id="queueLen">0</b></span>
      </div>

      <div class="kpi">
        <span class="badge">Now: <b id="now">—</b></span>
        <span class="badge">Next: <b id="next">—</b></span>
        <span class="badge">Status: <b id="status">Idle</b></span>
      </div>

      <div style="margin-top:10px;">
        <textarea id="text" placeholder="Example: HELLO THANK YOU
or: can you help me please"></textarea>
      </div>

      <div class="queueBox">
        <div class="muted">Queue preview (first 20):</div>
        <div id="preview" class="muted" style="margin-top:6px;"></div>
      </div>

      <div class="muted" style="margin-top:10px;">
        Tip: Put your clips here:
        <br/>• Letters: <code>/assets/asl/letters/A.mp4</code> … <code>Z.mp4</code> + <code>SPACE.mp4</code>
        <br/>• Words: <code>/assets/asl/words/HELLO.mp4</code> etc.
      </div>
    </div>

    <div class="panel">
      <div class="stage">
        <video id="player" playsinline muted></video>
        <div class="overlay">
          <div class="pill">ASL Player</div>
          <div class="pill" id="overlayPill">—</div>
        </div>
      </div>
      <div class="muted" style="margin-top:10px;">
        If video doesn’t play on first click, Chrome sometimes requires a user gesture. Click <b>Play</b> once.
      </div>
    </div>
  </div>

  <script type="module" src="./js/avatar_dict.js"></script>
</body>
</html>
